;define(function(require){'use strict';var a=require('underscore'),i=require('core/app-utils'),e={};var o={lat:'48.858554',lng:'2.294492',altitude:'0',accuracy:'0',altitudeAccuracy:'0',heading:'0',speed:'0',timestamp:'none'};var n=function(t){if(t.hasOwnProperty('coords')){o.lat=t.coords.latitude;o.lng=t.coords.longitude;o.altitude=t.coords.altitude;o.accuracy=t.coords.accuracy;o.altitudeAccuracy=t.coords.altitudeAccuracy;o.heading=t.coords.heading;o.speed=t.coords.speed;o.timestamp=t.hasOwnProperty('timestamp')&&parseInt(t.timestamp)>0?t.timestamp:0}};e.updateCurrentPosition=function(t,e){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(e){n(e);i.log('Geolocation : position retrieved',e);t(o)},function(){i.log('Geolocation : navigator.geolocation.getCurrentPosition() failed');e('navigator-no-position')})}else{i.log('Geolocation : no support for geolocation');e('no-support-for-geolocation')}};e.getCurrentPosition=function(t,i){if(o.timestamp!=='none'){t(o)}else{e.updateCurrentPosition(t,i)}};return e});