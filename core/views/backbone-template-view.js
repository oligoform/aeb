;define(function(require){'use strict';var $=require('jquery'),t=require('underscore'),a=require('backbone'),m=require('core/lib/hooks'),l=require('core/app-utils'),i=require('core/app'),n=function(e){t.bindAll(this,'checkTemplate','setTemplate');a.View.apply(this,[e])};t.extend(n.prototype,a.View.prototype,{screen_data:null,template_name:'default',fallback_template_name:'',template:null,is_static:!1,checkTemplate:function(a,m){var n=this,i='text!';if(this.template_name.match(/^addons\//g)){i+=this.template_name}else{i+='theme/'+this.template_name};i+='.html';var p=function(e){l.log('Error : view templates "'+n.template_name+'.html" and fallback "'+n.fallback_template_name+'.html" not found in theme');if(m){m()}},o=function(i){if(n.fallback_template_name!=''){l.log('View template "'+n.template_name+'.html" not found in theme : load fallback template "'+n.fallback_template_name+'"');require(['text!theme/'+n.fallback_template_name+'.html'],function(e){if(e.length){n.template=t.template(e);a()}else{p()}},function(e){p(e)})}else{l.log('Error : view template "'+n.template_name+'.html" not found in theme');if(m){m()}}};require([i],function(e){if(e.length){n.template=t.template(e);a()}else{o()}},function(e){o(e)})},setTemplate:function(e,t){var a=e!=undefined?e:'';a=m.applyFilters('template',a,[i.getQueriedScreen()]);if(a!=''){this.template_name=a;if(t!=undefined&&t!=''){this.fallback_template_name=t}}}});n.extend=a.View.extend;return n});