;var JSEncryptExports={};(function(exports){var l,G=0xdeadbeefcafe,L=((G&0xffffff)==0xefcafe);function e(t,e,i){if(t!=null)if('number'==typeof t)this.fromNumber(t,e,i);else if(e==null&&'string'!=typeof t)this.fromString(t,256);else this.fromString(t,e)};function i(){return new e(null)};function Y(t,e,i,s,r,n){while(--n>=0){var o=e*this[t++]+i[s]+r;r=Math.floor(o/0x4000000);i[s++]=o&0x3ffffff};return r};function W(t,e,i,r,s,n){var u=e&0x7fff,f=e>>15;while(--n>=0){var o=this[t]&0x7fff,h=this[t++]>>15,a=f*o+h*u;o=u*o+((a&0x7fff)<<15)+i[r]+(s&0x3fffffff);s=(o>>>30)+(a>>>15)+f*h+(s>>>30);i[r++]=o&0x3fffffff};return s};function Q(t,e,i,s,r,n){var u=e&0x3fff,f=e>>14;while(--n>=0){var o=this[t]&0x3fff,h=this[t++]>>14,a=f*o+h*u;o=u*o+((a&0x3fff)<<14)+i[s]+r;r=(o>>28)+(a>>14)+f*h;i[s++]=o&0xfffffff};return r};if(L&&(navigator.appName=='Microsoft Internet Explorer')){e.prototype.am=W;l=30}else if(L&&(navigator.appName!='Netscape')){e.prototype.am=Y;l=26}else{e.prototype.am=Q;l=28};e.prototype.DB=l;e.prototype.DM=((1<<l)-1);e.prototype.DV=(1<<l);var V=52;e.prototype.FV=Math.pow(2,V);e.prototype.F1=V-l;e.prototype.F2=2*l-V;var Z='0123456789abcdefghijklmnopqrstuvwxyz',D=[],y,h;y='0'.charCodeAt(0);for(h=0;h<=9;++h)D[y++]=h;y='a'.charCodeAt(0);for(h=10;h<36;++h)D[y++]=h;y='A'.charCodeAt(0);for(h=10;h<36;++h)D[y++]=h;function f(t){return Z.charAt(t)};function q(t,e){var i=D[t.charCodeAt(e)];return(i==null)?-1:i};function X(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t;t.s=this.s};function tt(t){this.t=1;this.s=(t<0)?-1:0;if(t>0)this[0]=t;else if(t<-1)this[0]=t+this.DV;else this.t=0};function p(t){var e=i();e.fromInt(t);return e};function et(t,i){var r;if(i==16)r=4;else if(i==8)r=3;else if(i==256)r=8;else if(i==2)r=1;else if(i==32)r=5;else if(i==4)r=2;else{this.fromRadix(t,i);return};this.t=0;this.s=0;var o=t.length,h=!1,s=0;while(--o>=0){var n=(r==8)?t[o]&0xff:q(t,o);if(n<0){if(t.charAt(o)=='-')h=!0;continue};h=!1;if(s==0)this[this.t++]=n;else if(s+r>this.DB){this[this.t-1]|=(n&((1<<(this.DB-s))-1))<<s;this[this.t++]=(n>>(this.DB-s))}else this[this.t-1]|=n<<s;s+=r;if(s>=this.DB)s-=this.DB};if(r==8&&(t[0]&0x80)!=0){this.s=-1;if(s>0)this[this.t-1]|=((1<<(this.DB-s))-1)<<s};this.clamp();if(h)e.ZERO.subTo(this,this)};function it(){var t=this.s&this.DM;while(this.t>0&&this[this.t-1]==t)--this.t};function st(t){if(this.s<0)return'-'+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var h=(1<<e)-1,r,n=!1,o='',s=this.t,i=this.DB-(s*this.DB)%e;if(s-->0){if(i<this.DB&&(r=this[s]>>i)>0){n=!0;o=f(r)}while(s>=0){if(i<e){r=(this[s]&((1<<i)-1))<<(e-i);r|=this[--s]>>(i+=this.DB-e)}else{r=(this[s]>>(i-=e))&h;if(i<=0){i+=this.DB;--s}};if(r>0)n=!0;if(n)o+=f(r)}};return n?o:'0'};function rt(){var t=i();e.ZERO.subTo(this,t);return t};function nt(){return(this.s<0)?this.negate():this};function ot(t){var e=this.s-t.s;if(e!=0)return e;var i=this.t;e=i-t.t;if(e!=0)return(this.s<0)?-e:e;while(--i>=0)if((e=this[i]-t[i])!=0)return e;return 0};function x(t){var i=1,e;if((e=t>>>16)!=0){t=e;i+=16};if((e=t>>8)!=0){t=e;i+=8};if((e=t>>4)!=0){t=e;i+=4};if((e=t>>2)!=0){t=e;i+=2};if((e=t>>1)!=0){t=e;i+=1};return i};function ht(){if(this.t<=0)return 0;return this.DB*(this.t-1)+x(this[this.t-1]^(this.s&this.DM))};function at(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t;e.s=this.s};function ut(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0);e.s=this.s};function ft(t,e){var r=t%this.DB,o=this.DB-r,h=(1<<o)-1,s=Math.floor(t/this.DB),n=(this.s<<r)&this.DM,i;for(i=this.t-1;i>=0;--i){e[i+s+1]=(this[i]>>o)|n;n=(this[i]&h)<<r};for(i=s-1;i>=0;--i)e[i]=0;e[s]=n;e.t=this.t+s+1;e.s=this.s;e.clamp()};function ct(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t){e.t=0;return};var r=t%this.DB,n=this.DB-r,o=(1<<r)-1;e[0]=this[i]>>r;for(var s=i+1;s<this.t;++s){e[s-i-1]|=(this[s]&o)<<n;e[s-i]=this[s]>>r};if(r>0)e[this.t-i-1]|=(this.s&o)<<n;e.t=this.t-i;e.clamp()};function lt(t,e){var s=0,i=0,r=Math.min(t.t,this.t);while(s<r){i+=this[s]-t[s];e[s++]=i&this.DM;i>>=this.DB};if(t.t<this.t){i-=t.s;while(s<this.t){i+=this[s];e[s++]=i&this.DM;i>>=this.DB};i+=this.s}else{i+=this.s;while(s<t.t){i-=t[s];e[s++]=i&this.DM;i>>=this.DB};i-=t.s};e.s=(i<0)?-1:0;if(i<-1)e[s++]=this.DV+i;else if(i>0)e[s++]=i;e.t=s;e.clamp()};function pt(t,i){var r=this.abs(),n=t.abs(),s=r.t;i.t=s+n.t;while(--s>=0)i[s]=0;for(s=0;s<n.t;++s)i[s+r.t]=r.am(0,n[s],i,s,0,r.t);i.s=0;i.clamp();if(this.s!=t.s)e.ZERO.subTo(i,i)};function dt(t){var i=this.abs(),e=t.t=2*i.t;while(--e>=0)t[e]=0;for(e=0;e<i.t-1;++e){var s=i.am(e,i[e],t,2*e,0,1);if((t[e+i.t]+=i.am(e+1,2*i[e],t,2*e+1,s,i.t-e-1))>=i.DV){t[e+i.t]-=i.DV;t[e+i.t+1]=1}};if(t.t>0)t[t.t-1]+=i.am(e,i[e],t,2*e,0,1);t.s=0;t.clamp()};function gt(t,s,r){var u=t.abs();if(u.t<=0)return;var d=this.abs();if(d.t<u.t){if(s!=null)s.fromInt(0);if(r!=null)this.copyTo(r);return};if(r==null)r=i();var n=i(),m=this.s,T=t.s,f=this.DB-x(u[u.t-1]);if(f>0){u.lShiftTo(f,n);d.lShiftTo(f,r)}else{u.copyTo(n);d.copyTo(r)};var o=n.t,p=n[o-1];if(p==0)return;var g=p*(1<<this.F1)+((o>1)?n[o-2]>>this.F2:0),v=this.FV/g,y=(1<<this.F1)/g,b=1<<this.F2,a=r.t,c=a-o,h=(s==null)?i():s;n.dlShiftTo(c,h);if(r.compareTo(h)>=0){r[r.t++]=1;r.subTo(h,r)};e.ONE.dlShiftTo(o,h);h.subTo(n,n);while(n.t<o)n[n.t++]=0;while(--c>=0){var l=(r[--a]==p)?this.DM:Math.floor(r[a]*v+(r[a-1]+b)*y);if((r[a]+=n.am(0,l,r,c,0,o))<l){n.dlShiftTo(c,h);r.subTo(h,r);while(r[a]<--l)r.subTo(h,r)}};if(s!=null){r.drShiftTo(o,s);if(m!=T)e.ZERO.subTo(s,s)};r.t=o;r.clamp();if(f>0)r.rShiftTo(f,r);if(m<0)e.ZERO.subTo(r,r)};function mt(t){var s=i();this.abs().divRemTo(t,null,s);if(this.s<0&&s.compareTo(e.ZERO)>0)t.subTo(s,s);return s};function d(t){this.m=t};function vt(t){if(t.s<0||t.compareTo(this.m)>=0)return t.mod(this.m);else return t};function yt(t){return t};function bt(t){t.divRemTo(this.m,null,t)};function Tt(t,e,i){t.multiplyTo(e,i);this.reduce(i)};function St(t,e){t.squareTo(e);this.reduce(e)};d.prototype.convert=vt;d.prototype.revert=yt;d.prototype.reduce=bt;d.prototype.mulTo=Tt;d.prototype.sqrTo=St;function wt(){if(this.t<1)return 0;var e=this[0];if((e&1)==0)return 0;var t=e&3;t=(t*(2-(e&0xf)*t))&0xf;t=(t*(2-(e&0xff)*t))&0xff;t=(t*(2-(((e&0xffff)*t)&0xffff)))&0xffff;t=(t*(2-e*t%this.DV))%this.DV;return(t>0)?this.DV-t:-t};function g(t){this.m=t;this.mp=t.invDigit();this.mpl=this.mp&0x7fff;this.mph=this.mp>>15;this.um=(1<<(t.DB-15))-1;this.mt2=2*t.t};function Rt(t){var s=i();t.abs().dlShiftTo(this.m.t,s);s.divRemTo(this.m,null,s);if(t.s<0&&s.compareTo(e.ZERO)>0)this.m.subTo(s,s);return s};function Et(t){var e=i();t.copyTo(e);this.reduce(e);return e};function Dt(t){while(t.t<=this.mt2)t[t.t++]=0;for(var i=0;i<this.m.t;++i){var e=t[i]&0x7fff,s=(e*this.mpl+(((e*this.mph+(t[i]>>15)*this.mpl)&this.um)<<15))&t.DM;e=i+this.m.t;t[e]+=this.m.am(0,s,t,i,0,this.m.t);while(t[e]>=t.DV){t[e]-=t.DV;t[++e]++}};t.clamp();t.drShiftTo(this.m.t,t);if(t.compareTo(this.m)>=0)t.subTo(this.m,t)};function xt(t,e){t.squareTo(e);this.reduce(e)};function Bt(t,e,i){t.multiplyTo(e,i);this.reduce(i)};g.prototype.convert=Rt;g.prototype.revert=Et;g.prototype.reduce=Dt;g.prototype.mulTo=Bt;g.prototype.sqrTo=xt;function Kt(){return((this.t>0)?(this[0]&1):this.s)==0};function Ut(t,s){if(t>0xffffffff||t<1)return e.ONE;var r=i(),n=i(),o=s.convert(this),h=x(t)-1;o.copyTo(r);while(--h>=0){s.sqrTo(r,n);if((t&(1<<h))>0)s.mulTo(n,o,r);else{var a=r;r=n;n=a}};return s.revert(r)};function At(t,e){var i;if(t<256||e.isEven())i=new d(e);else i=new g(e);return this.exp(t,i)};e.prototype.copyTo=X;e.prototype.fromInt=tt;e.prototype.fromString=et;e.prototype.clamp=it;e.prototype.dlShiftTo=at;e.prototype.drShiftTo=ut;e.prototype.lShiftTo=ft;e.prototype.rShiftTo=ct;e.prototype.subTo=lt;e.prototype.multiplyTo=pt;e.prototype.squareTo=dt;e.prototype.divRemTo=gt;e.prototype.invDigit=wt;e.prototype.isEven=Kt;e.prototype.exp=Ut;e.prototype.toString=st;e.prototype.negate=rt;e.prototype.abs=nt;e.prototype.compareTo=ot;e.prototype.bitLength=ht;e.prototype.mod=mt;e.prototype.modPowInt=At;e.ZERO=p(0);e.ONE=p(1);function Ot(){var t=i();this.copyTo(t);return t};function Vt(){if(this.s<0){if(this.t==1)return this[0]-this.DV;else if(this.t==0)return-1}else if(this.t==1)return this[0];else if(this.t==0)return 0;return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]};function Jt(){return(this.t==0)?this.s:(this[0]<<24)>>24};function Nt(){return(this.t==0)?this.s:(this[0]<<16)>>16};function It(t){return Math.floor(Math.LN2*this.DB/Math.log(t))};function Pt(){if(this.s<0)return-1;else if(this.t<=0||(this.t==1&&this[0]<=0))return 0;else return 1};function Mt(t){if(t==null)t=10;if(this.signum()==0||t<2||t>36)return'0';var h=this.chunkSize(t),n=Math.pow(t,h),o=p(n),e=i(),s=i(),r='';this.divRemTo(o,e,s);while(e.signum()>0){r=(n+s.intValue()).toString(t).substr(1)+r;e.divRemTo(o,e,s)};return s.intValue().toString(t)+r};function Lt(t,i){this.fromInt(0);if(i==null)i=10;var h=this.chunkSize(i),u=Math.pow(i,h),a=!1,n=0,s=0;for(var r=0;r<t.length;++r){var o=q(t,r);if(o<0){if(t.charAt(r)=='-'&&this.signum()==0)a=!0;continue};s=i*s+o;if(++n>=h){this.dMultiply(u);this.dAddOffset(s,0);n=0;s=0}};if(n>0){this.dMultiply(Math.pow(i,n));this.dAddOffset(s,0)};if(a)e.ZERO.subTo(this,this)};function qt(t,i,s){if('number'==typeof i){if(t<2)this.fromInt(1);else{this.fromNumber(t,s);if(!this.testBit(t-1))this.bitwiseTo(e.ONE.shiftLeft(t-1),B,this);if(this.isEven())this.dAddOffset(1,0);while(!this.isProbablePrime(i)){this.dAddOffset(2,0);if(this.bitLength()>t)this.subTo(e.ONE.shiftLeft(t-1),this)}}}else{var r=[],n=t&7;r.length=(t>>3)+1;i.nextBytes(r);if(n>0)r[0]&=((1<<n)-1);else r[0]=0;this.fromString(r,256)}};function Ct(){var i=this.t,r=[];r[0]=this.s;var t=this.DB-(i*this.DB)%8,e,s=0;if(i-->0){if(t<this.DB&&(e=this[i]>>t)!=(this.s&this.DM)>>t)r[s++]=e|(this.s<<(this.DB-t));while(i>=0){if(t<8){e=(this[i]&((1<<t)-1))<<(8-t);e|=this[--i]>>(t+=this.DB-8)}else{e=(this[i]>>(t-=8))&0xff;if(t<=0){t+=this.DB;--i}};if((e&0x80)!=0)e|=-256;if(s==0&&(this.s&0x80)!=(e&0x80))++s;if(s>0||e!=this.s)r[s++]=e}};return r};function Ht(t){return(this.compareTo(t)==0)};function kt(t){return(this.compareTo(t)<0)?this:t};function jt(t){return(this.compareTo(t)>0)?this:t};function Ft(t,e,i){var s,r,n=Math.min(t.t,this.t);for(s=0;s<n;++s)i[s]=e(this[s],t[s]);if(t.t<this.t){r=t.s&this.DM;for(s=n;s<this.t;++s)i[s]=e(this[s],r);i.t=this.t}else{r=this.s&this.DM;for(s=n;s<t.t;++s)i[s]=e(r,t[s]);i.t=t.t};i.s=e(this.s,t.s);i.clamp()};function zt(t,e){return t&e};function Zt(t){var e=i();this.bitwiseTo(t,zt,e);return e};function B(t,e){return t|e};function Gt(t){var e=i();this.bitwiseTo(t,B,e);return e};function C(t,e){return t^e};function Yt(t){var e=i();this.bitwiseTo(t,C,e);return e};function H(t,e){return t&~e};function Wt(t){var e=i();this.bitwiseTo(t,H,e);return e};function Qt(){var e=i();for(var t=0;t<this.t;++t)e[t]=this.DM&~this[t];e.t=this.t;e.s=~this.s;return e};function Xt(t){var e=i();if(t<0)this.rShiftTo(-t,e);else this.lShiftTo(t,e);return e};function te(t){var e=i();if(t<0)this.lShiftTo(-t,e);else this.rShiftTo(t,e);return e};function ee(t){if(t==0)return-1;var e=0;if((t&0xffff)==0){t>>=16;e+=16};if((t&0xff)==0){t>>=8;e+=8};if((t&0xf)==0){t>>=4;e+=4};if((t&3)==0){t>>=2;e+=2};if((t&1)==0)++e;return e};function ie(){for(var t=0;t<this.t;++t)if(this[t]!=0)return t*this.DB+ee(this[t]);if(this.s<0)return this.t*this.DB;return-1};function se(t){var e=0;while(t!=0){t&=t-1;++e};return e};function re(){var e=0,i=this.s&this.DM;for(var t=0;t<this.t;++t)e+=se(this[t]^i);return e};function ne(t){var e=Math.floor(t/this.DB);if(e>=this.t)return(this.s!=0);return((this[e]&(1<<(t%this.DB)))!=0)};function oe(t,i){var s=e.ONE.shiftLeft(t);this.bitwiseTo(s,i,s);return s};function he(t){return this.changeBit(t,B)};function ae(t){return this.changeBit(t,H)};function ue(t){return this.changeBit(t,C)};function fe(t,e){var s=0,i=0,r=Math.min(t.t,this.t);while(s<r){i+=this[s]+t[s];e[s++]=i&this.DM;i>>=this.DB};if(t.t<this.t){i+=t.s;while(s<this.t){i+=this[s];e[s++]=i&this.DM;i>>=this.DB};i+=this.s}else{i+=this.s;while(s<t.t){i+=t[s];e[s++]=i&this.DM;i>>=this.DB};i+=t.s};e.s=(i<0)?-1:0;if(i>0)e[s++]=i;else if(i<-1)e[s++]=this.DV+i;e.t=s;e.clamp()};function ce(t){var e=i();this.addTo(t,e);return e};function le(t){var e=i();this.subTo(t,e);return e};function pe(t){var e=i();this.multiplyTo(t,e);return e};function de(){var t=i();this.squareTo(t);return t};function ge(t){var e=i();this.divRemTo(t,e,null);return e};function me(t){var e=i();this.divRemTo(t,null,e);return e};function ve(t){var e=i(),s=i();this.divRemTo(t,e,s);return new Array(e,s)};function ye(t){this[this.t]=this.am(0,t-1,this,0,0,this.t);++this.t;this.clamp()};function be(t,e){if(t==0)return;while(this.t<=e)this[this.t++]=0;this[e]+=t;while(this[e]>=this.DV){this[e]-=this.DV;if(++e>=this.t)this[this.t++]=0;++this[e]}};function S(){};function k(t){return t};function Te(t,e,i){t.multiplyTo(e,i)};function Se(t,e){t.squareTo(e)};S.prototype.convert=k;S.prototype.revert=k;S.prototype.mulTo=Te;S.prototype.sqrTo=Se;function we(t){return this.exp(t,new S())};function Re(t,e,i){var s=Math.min(this.t+t.t,e);i.s=0;i.t=s;while(s>0)i[--s]=0;var r;for(r=i.t-this.t;s<r;++s)i[s+this.t]=this.am(0,t[s],i,s,0,this.t);for(r=Math.min(t.t,e);s<r;++s)this.am(0,t[s],i,s,0,e-s);i.clamp()};function Ee(t,e,i){--e;var s=i.t=this.t+t.t-e;i.s=0;while(--s>=0)i[s]=0;for(s=Math.max(e-this.t,0);s<t.t;++s)i[this.t+s-e]=this.am(e-s,t[s],i,0,0,this.t+s-e);i.clamp();i.drShiftTo(1,i)};function b(t){this.r2=i();this.q3=i();e.ONE.dlShiftTo(2*t.t,this.r2);this.mu=this.r2.divide(t);this.m=t};function De(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);else if(t.compareTo(this.m)<0)return t;else{var e=i();t.copyTo(e);this.reduce(e);return e}};function xe(t){return t};function Be(t){t.drShiftTo(this.m.t-1,this.r2);if(t.t>this.m.t+1){t.t=this.m.t+1;t.clamp()};this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(t.compareTo(this.r2)<0)t.dAddOffset(1,this.m.t+1);t.subTo(this.r2,t);while(t.compareTo(this.m)>=0)t.subTo(this.m,t)};function Ke(t,e){t.squareTo(e);this.reduce(e)};function Ue(t,e,i){t.multiplyTo(e,i);this.reduce(i)};b.prototype.convert=De;b.prototype.revert=xe;b.prototype.reduce=Be;b.prototype.mulTo=Ue;b.prototype.sqrTo=Ke;function Ae(t,e){var s=t.bitLength(),u,r=p(1),n;if(s<=0)return r;else if(s<18)u=1;else if(s<48)u=3;else if(s<144)u=4;else if(s<768)u=5;else u=6;if(s<8)n=new d(e);else if(e.isEven())n=new b(e);else n=new g(e);var c=[],o=3,m=u-1,T=(1<<u)-1;c[1]=n.convert(this);if(u>1){var y=i();n.sqrTo(c[1],y);while(o<=T){c[o]=i();n.mulTo(y,c[o-2],c[o]);o+=2}};var h=t.t-1,f,v=!0,a=i(),l;s=x(t[h])-1;while(h>=0){if(s>=m)f=(t[h]>>(s-m))&T;else{f=(t[h]&((1<<(s+1))-1))<<(m-s);if(h>0)f|=t[h-1]>>(this.DB+s-m)};o=u;while((f&1)==0){f>>=1;--o};if((s-=o)<0){s+=this.DB;--h};if(v){c[f].copyTo(r);v=!1}else{while(o>1){n.sqrTo(r,a);n.sqrTo(a,r);o-=2};if(o>0)n.sqrTo(r,a);else{l=r;r=a;a=l};n.mulTo(a,c[f],r)}while(h>=0&&(t[h]&(1<<s))==0){n.sqrTo(r,a);l=r;r=a;a=l;if(--s<0){s=this.DB-1;--h}}};return n.revert(r)};function Oe(t){var i=(this.s<0)?this.negate():this.clone(),e=(t.s<0)?t.negate():t.clone();if(i.compareTo(e)<0){var n=i;i=e;e=n};var r=i.getLowestSetBit(),s=e.getLowestSetBit();if(s<0)return i;if(r<s)s=r;if(s>0){i.rShiftTo(s,i);e.rShiftTo(s,e)}while(i.signum()>0){if((r=i.getLowestSetBit())>0)i.rShiftTo(r,i);if((r=e.getLowestSetBit())>0)e.rShiftTo(r,e);if(i.compareTo(e)>=0){i.subTo(e,i);i.rShiftTo(1,i)}else{e.subTo(i,e);e.rShiftTo(1,e)}};if(s>0)e.lShiftTo(s,e);return e};function Ve(t){if(t<=0)return 0;var s=this.DV%t,e=(this.s<0)?t-1:0;if(this.t>0)if(s==0)e=this[0]%t;else for(var i=this.t-1;i>=0;--i)e=(s*e+this[i])%t;return e};function Je(t){var a=t.isEven();if((this.isEven()&&a)||t.signum()==0)return e.ZERO;var r=t.clone(),n=this.clone(),o=p(1),s=p(0),h=p(0),i=p(1);while(r.signum()!=0){while(r.isEven()){r.rShiftTo(1,r);if(a){if(!o.isEven()||!s.isEven()){o.addTo(this,o);s.subTo(t,s)};o.rShiftTo(1,o)}else if(!s.isEven())s.subTo(t,s);s.rShiftTo(1,s)}while(n.isEven()){n.rShiftTo(1,n);if(a){if(!h.isEven()||!i.isEven()){h.addTo(this,h);i.subTo(t,i)};h.rShiftTo(1,h)}else if(!i.isEven())i.subTo(t,i);i.rShiftTo(1,i)};if(r.compareTo(n)>=0){r.subTo(n,r);if(a)o.subTo(h,o);s.subTo(i,s)}else{n.subTo(r,n);if(a)h.subTo(o,h);i.subTo(s,i)}};if(n.compareTo(e.ONE)!=0)return e.ZERO;if(i.compareTo(t)>=0)return i.subtract(t);if(i.signum()<0)i.addTo(t,i);else return i;if(i.signum()<0)return i.add(t);else return i};var o=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],z=(1<<26)/o[o.length-1];function Ne(t){var e,i=this.abs();if(i.t==1&&i[0]<=o[o.length-1]){for(e=0;e<o.length;++e)if(i[0]==o[e])return!0;return!1};if(i.isEven())return!1;e=1;while(e<o.length){var s=o[e],r=e+1;while(r<o.length&&s<z)s*=o[r++];s=i.modInt(s);while(e<r)if(s%o[e++]==0)return!1};return i.millerRabin(t)};function Ie(t){var r=this.subtract(e.ONE),n=r.getLowestSetBit();if(n<=0)return!1;var f=r.shiftRight(n);t=(t+1)>>1;if(t>o.length)t=o.length;var a=i();for(var h=0;h<t;++h){a.fromInt(o[Math.floor(Math.random()*o.length)]);var s=a.modPow(f,this);if(s.compareTo(e.ONE)!=0&&s.compareTo(r)!=0){var u=1;while(u++<n&&s.compareTo(r)!=0){s=s.modPowInt(2,this);if(s.compareTo(e.ONE)==0)return!1};if(s.compareTo(r)!=0)return!1}};return!0};e.prototype.chunkSize=It;e.prototype.toRadix=Mt;e.prototype.fromRadix=Lt;e.prototype.fromNumber=qt;e.prototype.bitwiseTo=Ft;e.prototype.changeBit=oe;e.prototype.addTo=fe;e.prototype.dMultiply=ye;e.prototype.dAddOffset=be;e.prototype.multiplyLowerTo=Re;e.prototype.multiplyUpperTo=Ee;e.prototype.modInt=Ve;e.prototype.millerRabin=Ie;e.prototype.clone=Ot;e.prototype.intValue=Vt;e.prototype.byteValue=Jt;e.prototype.shortValue=Nt;e.prototype.signum=Pt;e.prototype.toByteArray=Ct;e.prototype.equals=Ht;e.prototype.min=kt;e.prototype.max=jt;e.prototype.and=Zt;e.prototype.or=Gt;e.prototype.xor=Yt;e.prototype.andNot=Wt;e.prototype.not=Qt;e.prototype.shiftLeft=Xt;e.prototype.shiftRight=te;e.prototype.getLowestSetBit=ie;e.prototype.bitCount=re;e.prototype.testBit=ne;e.prototype.setBit=he;e.prototype.clearBit=ae;e.prototype.flipBit=ue;e.prototype.add=ce;e.prototype.subtract=le;e.prototype.multiply=pe;e.prototype.divide=ge;e.prototype.remainder=me;e.prototype.divideAndRemainder=ve;e.prototype.modPow=Ae;e.prototype.modInverse=Je;e.prototype.pow=we;e.prototype.gcd=Oe;e.prototype.isProbablePrime=Ne;e.prototype.square=de;function J(){this.i=0;this.j=0;this.S=[]};function Pe(t){var e,i,s;for(e=0;e<256;++e)this.S[e]=e;i=0;for(e=0;e<256;++e){i=(i+this.S[e]+t[e%t.length])&255;s=this.S[e];this.S[e]=this.S[i];this.S[i]=s};this.i=0;this.j=0};function Me(){var t;this.i=(this.i+1)&255;this.j=(this.j+this.S[this.i])&255;t=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=t;return this.S[(t+this.S[this.i])&255]};J.prototype.init=Pe;J.prototype.next=Me;function Le(){return new J()};var M=256,E,c,u;if(c==null){c=[];u=0;var R;if(window.crypto&&window.crypto.getRandomValues){var O=new Uint32Array(256);window.crypto.getRandomValues(O);for(R=0;R<O.length;++R)c[u++]=O[R]&255};var w=function(t){this.count=this.count||0;if(this.count>=256||u>=M){if(window.removeEventListener)window.removeEventListener('mousemove',w);else if(window.detachEvent)window.detachEvent('onmousemove',w);return};this.count+=1;var e=t.x+t.y;c[u++]=e&255};if(window.addEventListener)window.addEventListener('mousemove',w);else if(window.attachEvent)window.attachEvent('onmousemove',w)};function qe(){if(E==null){E=Le();while(u<M){var t=Math.floor(65536*Math.random());c[u++]=t&255};E.init(c);for(u=0;u<c.length;++u)c[u]=0;u=0};return E.next()};function Ce(t){var e;for(e=0;e<t.length;++e)t[e]=qe()};function K(){};K.prototype.nextBytes=Ce;function n(t,i){return new e(t,i)};function Xe(t,e){var s='',i=0;while(i+e<t.length){s+=t.substring(i,i+e)+'\n';i+=e};return s+t.substring(i,t.length)};function ti(t){if(t<0x10)return'0'+t.toString(16);else return t.toString(16)};function He(t,i){if(i<t.length+11){console.error('Message too long for RSA');return null};var s=[],o=t.length-1;while(o>=0&&i>0){var r=t.charCodeAt(o--);if(r<128){s[--i]=r}else if((r>127)&&(r<2048)){s[--i]=(r&63)|128;s[--i]=(r>>6)|192}else{s[--i]=(r&63)|128;s[--i]=((r>>6)&63)|128;s[--i]=(r>>12)|224}};s[--i]=0;var h=new K(),n=[];while(i>2){n[0]=0;while(n[0]==0)h.nextBytes(n);s[--i]=n[0]};s[--i]=2;s[--i]=0;return new e(s)};function r(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null};function ke(t,e){if(t!=null&&e!=null&&t.length>0&&e.length>0){this.n=n(t,16);this.e=parseInt(e,16)}else console.error('Invalid RSA public key')};function je(t){return t.modPowInt(this.e,this.n)};function Fe(t){var s=He(t,(this.n.bitLength()+7)>>3);if(s==null)return null;var i=this.doPublic(s);if(i==null)return null;var e=i.toString(16);if((e.length&1)==0)return e;else return'0'+e};r.prototype.doPublic=je;r.prototype.setPublic=ke;r.prototype.encrypt=Fe;function ze(t,e){var s=t.toByteArray(),i=0;while(i<s.length&&s[i]==0)++i;if(s.length-i!=e-1||s[i]!=2)return null;++i;while(s[i]!=0)if(++i>=s.length)return null;var n='';while(++i<s.length){var r=s[i]&255;if(r<128){n+=String.fromCharCode(r)}else if((r>191)&&(r<224)){n+=String.fromCharCode(((r&31)<<6)|(s[i+1]&63));++i}else{n+=String.fromCharCode(((r&15)<<12)|((s[i+1]&63)<<6)|(s[i+2]&63));i+=2}};return n};function Ze(t,e,i){if(t!=null&&e!=null&&t.length>0&&e.length>0){this.n=n(t,16);this.e=parseInt(e,16);this.d=n(i,16)}else console.error('Invalid RSA private key')};function Ge(t,e,i,s,r,o,h,a){if(t!=null&&e!=null&&t.length>0&&e.length>0){this.n=n(t,16);this.e=parseInt(e,16);this.d=n(i,16);this.p=n(s,16);this.q=n(r,16);this.dmp1=n(o,16);this.dmq1=n(h,16);this.coeff=n(a,16)}else console.error('Invalid RSA private key')};function Ye(t,i){var h=new K(),a=t>>1;this.e=parseInt(i,16);var s=new e(i,16);for(;;){for(;;){this.p=new e(t-a,1,h);if(this.p.subtract(e.ONE).gcd(s).compareTo(e.ONE)==0&&this.p.isProbablePrime(10))break};for(;;){this.q=new e(a,1,h);if(this.q.subtract(e.ONE).gcd(s).compareTo(e.ONE)==0&&this.q.isProbablePrime(10))break};if(this.p.compareTo(this.q)<=0){var u=this.p;this.p=this.q;this.q=u};var r=this.p.subtract(e.ONE),n=this.q.subtract(e.ONE),o=r.multiply(n);if(o.gcd(s).compareTo(e.ONE)==0){this.n=this.p.multiply(this.q);this.d=s.modInverse(o);this.dmp1=this.d.mod(r);this.dmq1=this.d.mod(n);this.coeff=this.q.modInverse(this.p);break}}};function We(t){if(this.p==null||this.q==null)return t.modPow(this.d,this.n);var e=t.mod(this.p).modPow(this.dmp1,this.p),i=t.mod(this.q).modPow(this.dmq1,this.q);while(e.compareTo(i)<0)e=e.add(this.p);return e.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)};function Qe(t){var i=n(t,16),e=this.doPrivate(i);if(e==null)return null;return ze(e,(this.n.bitLength()+7)>>3)};r.prototype.doPrivate=We;r.prototype.setPrivate=Ze;r.prototype.setPrivateEx=Ge;r.prototype.generate=Ye;r.prototype.decrypt=Qe;(function(){var n=function(t,s,n){var a=new K(),u=t>>1;this.e=parseInt(s,16);var o=new e(s,16),r=this,h=function(){var c=function(){if(r.p.compareTo(r.q)<=0){var a=r.p;r.p=r.q;r.q=a};var t=r.p.subtract(e.ONE),i=r.q.subtract(e.ONE),s=t.multiply(i);if(s.gcd(o).compareTo(e.ONE)==0){r.n=r.p.multiply(r.q);r.d=o.modInverse(s);r.dmp1=r.d.mod(t);r.dmq1=r.d.mod(i);r.coeff=r.q.modInverse(r.p);setTimeout(function(){n()},0)}else{setTimeout(h,0)}},s=function(){r.q=i();r.q.fromNumberAsync(u,1,a,function(){r.q.subtract(e.ONE).gcda(o,function(t){if(t.compareTo(e.ONE)==0&&r.q.isProbablePrime(10)){setTimeout(c,0)}else{setTimeout(s,0)}})})},f=function(){r.p=i();r.p.fromNumberAsync(t-u,1,a,function(){r.p.subtract(e.ONE).gcda(o,function(t){if(t.compareTo(e.ONE)==0&&r.p.isProbablePrime(10)){setTimeout(s,0)}else{setTimeout(f,0)}})})};setTimeout(f,0)};setTimeout(h,0)};r.prototype.generateAsync=n;var s=function(t,e){var s=(this.s<0)?this.negate():this.clone(),i=(t.s<0)?t.negate():t.clone();if(s.compareTo(i)<0){var h=s;s=i;i=h};var n=s.getLowestSetBit(),r=i.getLowestSetBit();if(r<0){e(s);return};if(n<r)r=n;if(r>0){s.rShiftTo(r,s);i.rShiftTo(r,i)};var o=function(){if((n=s.getLowestSetBit())>0){s.rShiftTo(n,s)};if((n=i.getLowestSetBit())>0){i.rShiftTo(n,i)};if(s.compareTo(i)>=0){s.subTo(i,s);s.rShiftTo(1,s)}else{i.subTo(s,i);i.rShiftTo(1,i)};if(!(s.signum()>0)){if(r>0)i.lShiftTo(r,i);setTimeout(function(){e(i)},0)}else{setTimeout(o,0)}};setTimeout(o,10)};e.prototype.gcda=s;var t=function(t,i,s,r){if('number'==typeof i){if(t<2){this.fromInt(1)}else{this.fromNumber(t,s);if(!this.testBit(t-1)){this.bitwiseTo(e.ONE.shiftLeft(t-1),B,this)};if(this.isEven()){this.dAddOffset(1,0)};var o=this,a=function(){o.dAddOffset(2,0);if(o.bitLength()>t)o.subTo(e.ONE.shiftLeft(t-1),o);if(o.isProbablePrime(i)){setTimeout(function(){r()},0)}else{setTimeout(a,0)}};setTimeout(a,0)}}else{var n=[],h=t&7;n.length=(t>>3)+1;i.nextBytes(n);if(h>0)n[0]&=((1<<h)-1);else n[0]=0;this.fromString(n,256)}};e.prototype.fromNumberAsync=t})();var m='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',P='=';function N(t){var e,i,s='';for(e=0;e+3<=t.length;e+=3){i=parseInt(t.substring(e,e+3),16);s+=m.charAt(i>>6)+m.charAt(i&63)};if(e+1==t.length){i=parseInt(t.substring(e,e+1),16);s+=m.charAt(i<<2)}else if(e+2==t.length){i=parseInt(t.substring(e,e+2),16);s+=m.charAt(i>>2)+m.charAt((i&3)<<4)}while((s.length&3)>0)s+=P;return s};function j(t){var e='',r,i=0,s;for(r=0;r<t.length;++r){if(t.charAt(r)==P)break;v=m.indexOf(t.charAt(r));if(v<0)continue;if(i==0){e+=f(v>>2);s=v&3;i=1}else if(i==1){e+=f((s<<2)|(v>>4));s=v&0xf;i=2}else if(i==2){e+=f(s);e+=f(v>>2);s=v&3;i=3}else{e+=f((s<<2)|(v>>4));e+=f(v&0xf);i=0}};if(i==1)e+=f(s<<2);return e};function ei(t){var i=j(t),e,s=[];for(e=0;2*e<i.length;++e){s[e]=parseInt(i.substring(2*e,2*e+2),16)};return s};var s=s||{};s.env=s.env||{};var U=s,A=Object.prototype,F='[object Function]',I=['toString','valueOf'];s.env.parseUA=function(t){var r=function(t){var e=0;return parseFloat(t.replace(/\./g,function(){return(e++==1)?'':'.'}))},n=navigator,i={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:n&&n.cajaVersion,secure:!1,os:null},s=t||(navigator&&navigator.userAgent),o=window&&window.location,h=o&&o.href,e;i.secure=h&&(h.toLowerCase().indexOf('https')===0);if(s){if((/windows|win32/i).test(s)){i.os='windows'}else if((/macintosh/i).test(s)){i.os='macintosh'}else if((/rhino/i).test(s)){i.os='rhino'};if((/KHTML/).test(s)){i.webkit=1};e=s.match(/AppleWebKit\/([^\s]*)/);if(e&&e[1]){i.webkit=r(e[1]);if(/ Mobile\//.test(s)){i.mobile='Apple';e=s.match(/OS ([^\s]*)/);if(e&&e[1]){e=r(e[1].replace('_','.'))};i.ios=e;i.ipad=i.ipod=i.iphone=0;e=s.match(/iPad|iPod|iPhone/);if(e&&e[0]){i[e[0].toLowerCase()]=i.ios}}else{e=s.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/);if(e){i.mobile=e[0]};if(/webOS/.test(s)){i.mobile='WebOS';e=s.match(/webOS\/([^\s]*);/);if(e&&e[1]){i.webos=r(e[1])}};if(/ Android/.test(s)){i.mobile='Android';e=s.match(/Android ([^\s]*);/);if(e&&e[1]){i.android=r(e[1])}}};e=s.match(/Chrome\/([^\s]*)/);if(e&&e[1]){i.chrome=r(e[1])}else{e=s.match(/AdobeAIR\/([^\s]*)/);if(e){i.air=e[0]}}};if(!i.webkit){e=s.match(/Opera[\s\/]([^\s]*)/);if(e&&e[1]){i.opera=r(e[1]);e=s.match(/Version\/([^\s]*)/);if(e&&e[1]){i.opera=r(e[1])};e=s.match(/Opera Mini[^;]*/);if(e){i.mobile=e[0]}}else{e=s.match(/MSIE\s([^;]*)/);if(e&&e[1]){i.ie=r(e[1])}else{e=s.match(/Gecko\/([^\s]*)/);if(e){i.gecko=1;e=s.match(/rv:([^\s\)]*)/);if(e&&e[1]){i.gecko=r(e[1])}}}}}};return i};s.env.ua=s.env.parseUA();s.isFunction=function(t){return(typeof t==='function')||A.toString.apply(t)===F};s._IEEnumFix=(s.env.ua.ie)?function(t,e){var i,s,r;for(i=0;i<I.length;i=i+1){s=I[i];r=e[s];if(U.isFunction(r)&&r!=A[s]){t[s]=r}}}:function(){};s.extend=function(t,e,i){if(!e||!t){throw new Error('extend failed, please check that all dependencies are included.')};var r=function(){},s;r.prototype=e.prototype;t.prototype=new r();t.prototype.constructor=t;t.superclass=e.prototype;if(e.prototype.constructor==A.constructor){e.prototype.constructor=e};if(i){for(s in i){if(U.hasOwnProperty(i,s)){t.prototype[s]=i[s]}};U._IEEnumFix(t.prototype,i)}};if(typeof KJUR=='undefined'||!KJUR)KJUR={};if(typeof KJUR.asn1=='undefined'||!KJUR.asn1)KJUR.asn1={};KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);if((e.length%2)==1)e='0'+e;return e};this.bigIntToMinTwosComplementsHex=function(t){var i=t.toString(16);if(i.substr(0,1)!='-'){if(i.length%2==1){i='0'+i}else{if(!i.match(/^[0-7]/)){i='00'+i}}}else{var a=i.substr(1),s=a.length;if(s%2==1){s+=1}else{if(!i.match(/^[0-7]/)){s+=2}};var n='';for(var r=0;r<s;r++){n+='f'};var o=new e(n,16),h=o.xor(t).add(e.ONE);i=h.toString(16).replace(/^-/,'')};return i};this.getPEMStringFromHex=function(t,e){var s=CryptoJS.enc.Hex.parse(t),r=CryptoJS.enc.Base64.stringify(s),i=r.replace(/(.{64})/g,'$1\r\n');i=i.replace(/\r\n$/,'');return'-----BEGIN '+e+'-----\r\n'+i+'\r\n-----END '+e+'-----\r\n'}};KJUR.asn1.ASN1Object=function(){var e=!0,i=null,s='00',r='00',t='';this.getLengthHexFromValue=function(){if(typeof this.hV=='undefined'||this.hV==null){throw'this.hV is null or undefined.'};if(this.hV.length%2==1){throw'value hex must be even length: n='+t.length+',v='+this.hV};var i=this.hV.length/2,e=i.toString(16);if(e.length%2==1){e='0'+e};if(i<128){return e}else{var s=e.length/2;if(s>15){throw'ASN.1 length too long to represent by 8x: n = '+i.toString(16)};var r=128+s;return r.toString(16)+e}};this.getEncodedHex=function(){if(this.hTLV==null||this.isModified){this.hV=this.getFreshValueHex();this.hL=this.getLengthHexFromValue();this.hTLV=this.hT+this.hL+this.hV;this.isModified=!1};return this.hTLV};this.getValueHex=function(){this.getEncodedHex();return this.hV};this.getFreshValueHex=function(){return''}};KJUR.asn1.DERAbstractString=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);var e=null,i=null;this.getString=function(){return this.s};this.setString=function(t){this.hTLV=null;this.isModified=!0;this.s=t;this.hV=stohex(this.s)};this.setStringHex=function(t){this.hTLV=null;this.isModified=!0;this.s=null;this.hV=t};this.getFreshValueHex=function(){return this.hV};if(typeof t!='undefined'){if(typeof t['str']!='undefined'){this.setString(t['str'])}else if(typeof t['hex']!='undefined'){this.setStringHex(t['hex'])}}};s.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object);KJUR.asn1.DERAbstractTime=function(t){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);var e=null,i=null;this.localDateToUTC=function(t){utc=t.getTime()+(t.getTimezoneOffset()*60000);var e=new Date(utc);return e};this.formatDate=function(t,e){var s=this.zeroPadding,i=this.localDateToUTC(t),r=String(i.getFullYear());if(e=='utc')r=r.substr(2,2);var n=s(String(i.getMonth()+1),2),o=s(String(i.getDate()),2),h=s(String(i.getHours()),2),a=s(String(i.getMinutes()),2),u=s(String(i.getSeconds()),2);return r+n+o+h+a+u+'Z'};this.zeroPadding=function(t,e){if(t.length>=e)return t;return new Array(e-t.length+1).join('0')+t};this.getString=function(){return this.s};this.setString=function(t){this.hTLV=null;this.isModified=!0;this.s=t;this.hV=stohex(this.s)};this.setByDateValue=function(t,e,i,s,r,n){var o=new Date(Date.UTC(t,e-1,i,s,r,n,0));this.setByDate(o)};this.getFreshValueHex=function(){return this.hV}};s.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object);KJUR.asn1.DERAbstractStructured=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);var e=null;this.setByASN1ObjectArray=function(t){this.hTLV=null;this.isModified=!0;this.asn1Array=t};this.appendASN1Object=function(t){this.hTLV=null;this.isModified=!0;this.asn1Array.push(t)};this.asn1Array=[];if(typeof t!='undefined'){if(typeof t['array']!='undefined'){this.asn1Array=t['array']}}};s.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object);KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this);this.hT='01';this.hTLV='0101ff'};s.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object);KJUR.asn1.DERInteger=function(t){KJUR.asn1.DERInteger.superclass.constructor.call(this);this.hT='02';this.setByBigInteger=function(t){this.hTLV=null;this.isModified=!0;this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)};this.setByInteger=function(t){var i=new e(String(t),10);this.setByBigInteger(i)};this.setValueHex=function(t){this.hV=t};this.getFreshValueHex=function(){return this.hV};if(typeof t!='undefined'){if(typeof t['bigint']!='undefined'){this.setByBigInteger(t['bigint'])}else if(typeof t['int']!='undefined'){this.setByInteger(t['int'])}else if(typeof t['hex']!='undefined'){this.setValueHex(t['hex'])}}};s.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object);KJUR.asn1.DERBitString=function(t){KJUR.asn1.DERBitString.superclass.constructor.call(this);this.hT='03';this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null;this.isModified=!0;this.hV=t};this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t){throw'unused bits shall be from 0 to 7: u = '+t};var i='0'+t;this.hTLV=null;this.isModified=!0;this.hV=i+e};this.setByBinaryString=function(t){t=t.replace(/0+$/,'');var s=8-t.length%8;if(s==8)s=0;for(var e=0;e<=s;e++){t+='0'};var r='';for(var e=0;e<t.length-1;e+=8){var n=t.substr(e,8),i=parseInt(n,2).toString(16);if(i.length==1)i='0'+i;r+=i};this.hTLV=null;this.isModified=!0;this.hV='0'+s+r};this.setByBooleanArray=function(t){var i='';for(var e=0;e<t.length;e++){if(t[e]==!0){i+='1'}else{i+='0'}};this.setByBinaryString(i)};this.newFalseArray=function(t){var i=new Array(t);for(var e=0;e<t;e++){i[e]=!1};return i};this.getFreshValueHex=function(){return this.hV};if(typeof t!='undefined'){if(typeof t['hex']!='undefined'){this.setHexValueIncludingUnusedBits(t['hex'])}else if(typeof t['bin']!='undefined'){this.setByBinaryString(t['bin'])}else if(typeof t['array']!='undefined'){this.setByBooleanArray(t['array'])}}};s.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object);KJUR.asn1.DEROctetString=function(t){KJUR.asn1.DEROctetString.superclass.constructor.call(this,t);this.hT='04'};s.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this);this.hT='05';this.hTLV='0500'};s.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object);KJUR.asn1.DERObjectIdentifier=function(t){var i=function(t){var e=t.toString(16);if(e.length==1)e='0'+e;return e},s=function(t){var a='',u=new e(t,10),r=u.toString(2),o=7-r.length%7;if(o==7)o=0;var h='';for(var s=0;s<o;s++)h+='0';r=h+r;for(var s=0;s<r.length-1;s+=7){var n=r.substr(s,7);if(s!=r.length-7)n='1'+n;a+=i(parseInt(n,2))};return a};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this);this.hT='06';this.setValueHex=function(t){this.hTLV=null;this.isModified=!0;this.s=null;this.hV=t};this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/)){throw'malformed oid string: '+t};var n='',e=t.split('.'),o=parseInt(e[0])*40+parseInt(e[1]);n+=i(o);e.splice(0,2);for(var r=0;r<e.length;r++){n+=s(e[r])};this.hTLV=null;this.isModified=!0;this.s=null;this.hV=n};this.setValueName=function(t){if(typeof KJUR.asn1.x509.OID.name2oidList[t]!='undefined'){var e=KJUR.asn1.x509.OID.name2oidList[t];this.setValueOidString(e)}else{throw'DERObjectIdentifier oidName undefined: '+t}};this.getFreshValueHex=function(){return this.hV};if(typeof t!='undefined'){if(typeof t['oid']!='undefined'){this.setValueOidString(t['oid'])}else if(typeof t['hex']!='undefined'){this.setValueHex(t['hex'])}else if(typeof t['name']!='undefined'){this.setValueName(t['name'])}}};s.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object);KJUR.asn1.DERUTF8String=function(t){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,t);this.hT='0c'};s.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString);KJUR.asn1.DERNumericString=function(t){KJUR.asn1.DERNumericString.superclass.constructor.call(this,t);this.hT='12'};s.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERPrintableString=function(t){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,t);this.hT='13'};s.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERTeletexString=function(t){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,t);this.hT='14'};s.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString);KJUR.asn1.DERIA5String=function(t){KJUR.asn1.DERIA5String.superclass.constructor.call(this,t);this.hT='16'};s.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString);KJUR.asn1.DERUTCTime=function(t){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,t);this.hT='17';this.setByDate=function(t){this.hTLV=null;this.isModified=!0;this.date=t;this.s=this.formatDate(this.date,'utc');this.hV=stohex(this.s)};if(typeof t!='undefined'){if(typeof t['str']!='undefined'){this.setString(t['str'])}else if(typeof t['hex']!='undefined'){this.setStringHex(t['hex'])}else if(typeof t['date']!='undefined'){this.setByDate(t['date'])}}};s.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime);KJUR.asn1.DERGeneralizedTime=function(t){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,t);this.hT='18';this.setByDate=function(t){this.hTLV=null;this.isModified=!0;this.date=t;this.s=this.formatDate(this.date,'gen');this.hV=stohex(this.s)};if(typeof t!='undefined'){if(typeof t['str']!='undefined'){this.setString(t['str'])}else if(typeof t['hex']!='undefined'){this.setStringHex(t['hex'])}else if(typeof t['date']!='undefined'){this.setByDate(t['date'])}}};s.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime);KJUR.asn1.DERSequence=function(t){KJUR.asn1.DERSequence.superclass.constructor.call(this,t);this.hT='30';this.getFreshValueHex=function(){var e='';for(var t=0;t<this.asn1Array.length;t++){var i=this.asn1Array[t];e+=i.getEncodedHex()};this.hV=e;return this.hV}};s.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured);KJUR.asn1.DERSet=function(t){KJUR.asn1.DERSet.superclass.constructor.call(this,t);this.hT='31';this.getFreshValueHex=function(){var e=[];for(var t=0;t<this.asn1Array.length;t++){var i=this.asn1Array[t];e.push(i.getEncodedHex())};e.sort();this.hV=e.join('');return this.hV}};s.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured);KJUR.asn1.DERTaggedObject=function(t){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this);this.hT='a0';this.hV='';this.isExplicit=!0;this.asn1Object=null;this.setASN1Object=function(t,e,i){this.hT=e;this.isExplicit=t;this.asn1Object=i;if(this.isExplicit){this.hV=this.asn1Object.getEncodedHex();this.hTLV=null;this.isModified=!0}else{this.hV=null;this.hTLV=i.getEncodedHex();this.hTLV=this.hTLV.replace(/^../,e);this.isModified=!1}};this.getFreshValueHex=function(){return this.hV};if(typeof t!='undefined'){if(typeof t['tag']!='undefined'){this.hT=t['tag']};if(typeof t['explicit']!='undefined'){this.isExplicit=t['explicit']};if(typeof t['obj']!='undefined'){this.asn1Object=t['obj'];this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)}}};s.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object);(function(t){'use strict';var i={},e;i.decode=function(i){var s;if(e===t){var o='0123456789ABCDEF',u=' \f\n\r\t\u00A0\u2028\u2029';e=[];for(s=0;s<16;++s)e[o.charAt(s)]=s;o=o.toLowerCase();for(s=10;s<16;++s)e[o.charAt(s)]=s;for(s=0;s<u.length;++s)e[u.charAt(s)]=-1};var h=[],n=0,a=0;for(s=0;s<i.length;++s){var r=i.charAt(s);if(r=='=')break;r=e[r];if(r==-1)continue;if(r===t)throw'Illegal character at offset '+s;n|=r;if(++a>=2){h[h.length]=n;n=0;a=0}else{n<<=4}};if(a)throw'Hex encoding incomplete: 4 bits missing';return h};window.Hex=i})();(function(t){'use strict';var e={},i;e.decode=function(e){var s;if(i===t){var u='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',a='= \f\n\r\t\u00A0\u2028\u2029';i=[];for(s=0;s<64;++s)i[u.charAt(s)]=s;for(s=0;s<a.length;++s)i[a.charAt(s)]=-1};var r=[],n=0,h=0;for(s=0;s<e.length;++s){var o=e.charAt(s);if(o=='=')break;o=i[o];if(o==-1)continue;if(o===t)throw'Illegal character at offset '+s;n|=o;if(++h>=4){r[r.length]=(n>>16);r[r.length]=(n>>8)&0xFF;r[r.length]=n&0xFF;n=0;h=0}else{n<<=6}};switch(h){case 1:throw'Base64 encoding incomplete: at least 2 bits missing';case 2:r[r.length]=(n>>10);break;case 3:r[r.length]=(n>>16);r[r.length]=(n>>8)&0xFF;break};return r};e.re=/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/;e.unarmor=function(t){var i=e.re.exec(t);if(i){if(i[1])t=i[1];else if(i[2])t=i[2];else throw'RegExp out of sync'};return e.decode(t)};window.Base64=e})();(function(t){'use strict';var r=100,n='\u2026',s={tag:function(t,e){var i=document.createElement(t);i.className=e;return i},text:function(t){return document.createTextNode(t)}};function i(t,e){if(t instanceof i){this.enc=t.enc;this.pos=t.pos}else{this.enc=t;this.pos=e}};i.prototype.get=function(e){if(e===t)e=this.pos++;if(e>=this.enc.length)throw'Requesting byte offset '+e+' on a stream of length '+this.enc.length;return this.enc[e]};i.prototype.hexDigits='0123456789ABCDEF';i.prototype.hexByte=function(t){return this.hexDigits.charAt((t>>4)&0xF)+this.hexDigits.charAt(t&0xF)};i.prototype.hexDump=function(t,e,i){var s='';for(var r=t;r<e;++r){s+=this.hexByte(this.get(r));if(i!==!0)switch(r&0xF){case 0x7:s+='  ';break;case 0xF:s+='\n';break;default:s+=' '}};return s};i.prototype.parseStringISO=function(t,e){var s='';for(var i=t;i<e;++i)s+=String.fromCharCode(this.get(i));return s};i.prototype.parseStringUTF=function(t,e){var r='';for(var s=t;s<e;){var i=this.get(s++);if(i<128)r+=String.fromCharCode(i);else if((i>191)&&(i<224))r+=String.fromCharCode(((i&0x1F)<<6)|(this.get(s++)&0x3F));else r+=String.fromCharCode(((i&0x0F)<<12)|((this.get(s++)&0x3F)<<6)|(this.get(s++)&0x3F))};return r};i.prototype.parseStringBMP=function(t,e){var s='';for(var i=t;i<e;i+=2){var r=this.get(i),n=this.get(i+1);s+=String.fromCharCode((r<<8)+n)};return s};i.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;i.prototype.parseTime=function(t,e){var s=this.parseStringISO(t,e),i=this.reTime.exec(s);if(!i)return'Unrecognized time: '+s;s=i[1]+'-'+i[2]+'-'+i[3]+' '+i[4];if(i[5]){s+=':'+i[5];if(i[6]){s+=':'+i[6];if(i[7])s+='.'+i[7]}};if(i[8]){s+=' UTC';if(i[8]!='Z'){s+=i[8];if(i[9])s+=':'+i[9]}};return s};i.prototype.parseInteger=function(t,e){var i=e-t;if(i>4){i<<=3;var n=this.get(t);if(n===0)i-=8;else while(n<128){n<<=1;--i};return'('+i+' bit)'};var r=0;for(var s=t;s<e;++s)r=(r<<8)|this.get(s);return r};i.prototype.parseBitString=function(t,e){var o=this.get(t),h=((e-t-1)<<3)-o,r='('+h+' bit)';if(h<=20){var n=o;r+=' ';for(var s=e-1;s>t;--s){var a=this.get(s);for(var i=n;i<8;++i)r+=(a>>i)&1?'1':'0';n=0}};return r};i.prototype.parseOctetString=function(t,e){var s=e-t,o='('+s+' byte) ';if(s>r)e=t+r;for(var i=t;i<e;++i)o+=this.hexByte(this.get(i));if(s>r)o+=n;return o};i.prototype.parseOID=function(t,e){var s='',i=0,n=0;for(var r=t;r<e;++r){var h=this.get(r);i=(i<<7)|(h&0x7F);n+=7;if(!(h&0x80)){if(s===''){var o=i<80?i<40?0:1:2;s=o+'.'+(i-o*40)}else s+='.'+((n>=31)?'bigint':i);i=n=0}};return s};function e(t,e,i,s,r){this.stream=t;this.header=e;this.length=i;this.tag=s;this.sub=r};e.prototype.typeName=function(){if(this.tag===t)return'unknown';var i=this.tag>>6,s=(this.tag>>5)&1,e=this.tag&0x1F;switch(i){case 0:switch(e){case 0x00:return'EOC';case 0x01:return'BOOLEAN';case 0x02:return'INTEGER';case 0x03:return'BIT_STRING';case 0x04:return'OCTET_STRING';case 0x05:return'NULL';case 0x06:return'OBJECT_IDENTIFIER';case 0x07:return'ObjectDescriptor';case 0x08:return'EXTERNAL';case 0x09:return'REAL';case 0x0A:return'ENUMERATED';case 0x0B:return'EMBEDDED_PDV';case 0x0C:return'UTF8String';case 0x10:return'SEQUENCE';case 0x11:return'SET';case 0x12:return'NumericString';case 0x13:return'PrintableString';case 0x14:return'TeletexString';case 0x15:return'VideotexString';case 0x16:return'IA5String';case 0x17:return'UTCTime';case 0x18:return'GeneralizedTime';case 0x19:return'GraphicString';case 0x1A:return'VisibleString';case 0x1B:return'GeneralString';case 0x1C:return'UniversalString';case 0x1E:return'BMPString';default:return'Universal_'+e.toString(16)};case 1:return'Application_'+e.toString(16);case 2:return'['+e+']';case 3:return'Private_'+e.toString(16)}};e.prototype.reSeemsASCII=/^[ -~]+$/;e.prototype.content=function(){if(this.tag===t)return null;var o=this.tag>>6,h=this.tag&0x1F,e=this.posContent(),i=Math.abs(this.length);if(o!==0){if(this.sub!==null)return'('+this.sub.length+' elem)';var s=this.stream.parseStringISO(e,e+Math.min(i,r));if(this.reSeemsASCII.test(s))return s.substring(0,2*r)+((s.length>2*r)?n:'');else return this.stream.parseOctetString(e,e+i)};switch(h){case 0x01:return(this.stream.get(e)===0)?'false':'true';case 0x02:return this.stream.parseInteger(e,e+i);case 0x03:return this.sub?'('+this.sub.length+' elem)':this.stream.parseBitString(e,e+i);case 0x04:return this.sub?'('+this.sub.length+' elem)':this.stream.parseOctetString(e,e+i);case 0x06:return this.stream.parseOID(e,e+i);case 0x10:case 0x11:return'('+this.sub.length+' elem)';case 0x0C:return this.stream.parseStringUTF(e,e+i);case 0x12:case 0x13:case 0x14:case 0x15:case 0x16:case 0x1A:return this.stream.parseStringISO(e,e+i);case 0x1E:return this.stream.parseStringBMP(e,e+i);case 0x17:case 0x18:return this.stream.parseTime(e,e+i)};return null};e.prototype.toString=function(){return this.typeName()+'@'+this.stream.pos+'[header:'+this.header+',length:'+this.length+',sub:'+((this.sub===null)?'null':this.sub.length)+']'};e.prototype.print=function(e){if(e===t)e='';document.writeln(e+this);if(this.sub!==null){e+='  ';for(var i=0,s=this.sub.length;i<s;++i)this.sub[i].print(e)}};e.prototype.toPrettyString=function(e){if(e===t)e='';var i=e+this.typeName()+' @'+this.stream.pos;if(this.length>=0)i+='+';i+=this.length;if(this.tag&0x20)i+=' (constructed)';else if(((this.tag==0x03)||(this.tag==0x04))&&(this.sub!==null))i+=' (encapsulates)';i+='\n';if(this.sub!==null){e+='  ';for(var s=0,r=this.sub.length;s<r;++s)i+=this.sub[s].toPrettyString(e)};return i};e.prototype.toDOM=function(){var e=s.tag('div','node');e.asn1=this;var n=s.tag('div','head'),t=this.typeName().replace(/_/g,' ');n.innerHTML=t;var i=this.content();if(i!==null){i=String(i).replace(/</g,'&lt;');var u=s.tag('span','preview');u.appendChild(s.text(i));n.appendChild(u)};e.appendChild(n);this.node=e;this.head=n;var a=s.tag('div','value');t='Offset: '+this.stream.pos+'<br/>';t+='Length: '+this.header+'+';if(this.length>=0)t+=this.length;else t+=(-this.length)+' (undefined)';if(this.tag&0x20)t+='<br/>(constructed)';else if(((this.tag==0x03)||(this.tag==0x04))&&(this.sub!==null))t+='<br/>(encapsulates)';if(i!==null){t+='<br/>Value:<br/><b>'+i+'</b>';if((typeof oids==='object')&&(this.tag==0x06)){var r=oids[i];if(r){if(r.d)t+='<br/>'+r.d;if(r.c)t+='<br/>'+r.c;if(r.w)t+='<br/>(warning!)'}}};a.innerHTML=t;e.appendChild(a);var h=s.tag('div','sub');if(this.sub!==null){for(var o=0,f=this.sub.length;o<f;++o)h.appendChild(this.sub[o].toDOM())};e.appendChild(h);n.onclick=function(){e.className=(e.className=='node collapsed')?'node':'node collapsed'};return e};e.prototype.posStart=function(){return this.stream.pos};e.prototype.posContent=function(){return this.stream.pos+this.header};e.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)};e.prototype.fakeHover=function(t){this.node.className+=' hover';if(t)this.head.className+=' hover'};e.prototype.fakeOut=function(t){var e=/ ?hover/;this.node.className=this.node.className.replace(e,'');if(t)this.head.className=this.head.className.replace(e,'')};e.prototype.toHexDOM_sub=function(t,e,i,r,n){if(r>=n)return;var o=s.tag('span',e);o.appendChild(s.text(i.hexDump(r,n)));t.appendChild(o)};e.prototype.toHexDOM=function(e){var i=s.tag('span','hex');if(e===t)e=i;this.head.hexNode=i;this.head.onmouseover=function(){this.hexNode.className='hexCurrent'};this.head.onmouseout=function(){this.hexNode.className='hex'};i.asn1=this;i.onmouseover=function(){var t=!e.selected;if(t){e.selected=this.asn1;this.className='hexCurrent'};this.asn1.fakeHover(t)};i.onmouseout=function(){var t=(e.selected==this.asn1);this.asn1.fakeOut(t);if(t){e.selected=null;this.className='hex'}};this.toHexDOM_sub(i,'tag',this.stream,this.posStart(),this.posStart()+1);this.toHexDOM_sub(i,(this.length>=0)?'dlen':'ulen',this.stream,this.posStart()+1,this.posContent());if(this.sub===null)i.appendChild(s.text(this.stream.hexDump(this.posContent(),this.posEnd())));else if(this.sub.length>0){var o=this.sub[0],h=this.sub[this.sub.length-1];this.toHexDOM_sub(i,'intro',this.stream,this.posContent(),o.posStart());for(var r=0,n=this.sub.length;r<n;++r)i.appendChild(this.sub[r].toHexDOM(e));this.toHexDOM_sub(i,'outro',this.stream,h.posEnd(),this.posEnd())};return i};e.prototype.toHexString=function(t){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)};e.decodeLength=function(t){var e=t.get(),i=e&0x7F;if(i==e)return i;if(i>3)throw'Length over 24 bits not supported at position '+(t.pos-1);if(i===0)return-1;e=0;for(var s=0;s<i;++s)e=(e<<8)|t.get();return e};e.hasContent=function(t,s,r){if(t&0x20)return!0;if((t<0x03)||(t>0x04))return!1;var n=new i(r);if(t==0x03)n.get();var a=n.get();if((a>>6)&0x01)return!1;try{var h=e.decodeLength(n);return((n.pos-r.pos)+h==s)}catch(o){return!1}};e.decode=function(t){if(!(t instanceof i))t=new i(t,0);var f=new i(t),h=t.get(),s=e.decodeLength(t),c=t.pos-f.pos,r=null;if(e.hasContent(h,s,t)){var o=t.pos;if(h==0x03)t.get();r=[];if(s>=0){var u=o+s;while(t.pos<u)r[r.length]=e.decode(t);if(t.pos!=u)throw'Content size is not correct for container starting at offset '+o}else{try{for(;;){var a=e.decode(t);if(a.tag===0)break;r[r.length]=a};s=o-t.pos}catch(n){throw'Exception while decoding undefined length content: '+n}}}else t.pos+=s;return new e(f,c,s,h,r)};e.test=function(){var s=[{value:[0x27],expected:0x27},{value:[0x81,0xC9],expected:0xC9},{value:[0x83,0xFE,0xDC,0xBA],expected:0xFEDCBA}];for(var t=0,o=s.length;t<o;++t){var h=0,n=new i(s[t].value,0),r=e.decodeLength(n);if(r!=s[t].expected)document.write('In test['+t+'] expected '+s[t].expected+' got '+r+'\n')}};window.ASN1=e})();ASN1.prototype.getHexStringValue=function(){var t=this.toHexString(),e=this.header*2,i=this.length*2;return t.substr(e,i)};r.prototype.parseKey=function(t){try{var i=0,s=0,d=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,g=d.test(t)?Hex.decode(t):Base64.unarmor(t),e=ASN1.decode(g);if(e.sub.length===3){e=e.sub[2].sub[0]};if(e.sub.length===9){i=e.sub[1].getHexStringValue();this.n=n(i,16);s=e.sub[2].getHexStringValue();this.e=parseInt(s,16);var p=e.sub[3].getHexStringValue();this.d=n(p,16);var l=e.sub[4].getHexStringValue();this.p=n(l,16);var c=e.sub[5].getHexStringValue();this.q=n(c,16);var f=e.sub[6].getHexStringValue();this.dmp1=n(f,16);var u=e.sub[7].getHexStringValue();this.dmq1=n(u,16);var a=e.sub[8].getHexStringValue();this.coeff=n(a,16)}else if(e.sub.length===2){var h=e.sub[1],o=h.sub[0];i=o.sub[0].getHexStringValue();this.n=n(i,16);s=o.sub[1].getHexStringValue();this.e=parseInt(s,16)}else{return!1};return!0}catch(r){return!1}};r.prototype.getPrivateBaseKey=function(){var e={'array':[new KJUR.asn1.DERInteger({'int':0}),new KJUR.asn1.DERInteger({'bigint':this.n}),new KJUR.asn1.DERInteger({'int':this.e}),new KJUR.asn1.DERInteger({'bigint':this.d}),new KJUR.asn1.DERInteger({'bigint':this.p}),new KJUR.asn1.DERInteger({'bigint':this.q}),new KJUR.asn1.DERInteger({'bigint':this.dmp1}),new KJUR.asn1.DERInteger({'bigint':this.dmq1}),new KJUR.asn1.DERInteger({'bigint':this.coeff})]};var t=new KJUR.asn1.DERSequence(e);return t.getEncodedHex()};r.prototype.getPrivateBaseKeyB64=function(){return N(this.getPrivateBaseKey())};r.prototype.getPublicBaseKey=function(){var t={'array':[new KJUR.asn1.DERObjectIdentifier({'oid':'1.2.840.113549.1.1.1'}),new KJUR.asn1.DERNull()]};var r=new KJUR.asn1.DERSequence(t);t={'array':[new KJUR.asn1.DERInteger({'bigint':this.n}),new KJUR.asn1.DERInteger({'int':this.e})]};var s=new KJUR.asn1.DERSequence(t);t={'hex':'00'+s.getEncodedHex()};var i=new KJUR.asn1.DERBitString(t);t={'array':[r,i]};var e=new KJUR.asn1.DERSequence(t);return e.getEncodedHex()};r.prototype.getPublicBaseKeyB64=function(){return N(this.getPublicBaseKey())};r.prototype.wordwrap=function(t,e){e=e||64;if(!t){return t};var i='(.{1,'+e+'})( +|$\n?)|(.{1,'+e+'})';return t.match(RegExp(i,'g')).join('\n')};r.prototype.getPrivateKey=function(){var t='-----BEGIN RSA PRIVATE KEY-----\n';t+=this.wordwrap(this.getPrivateBaseKeyB64())+'\n';t+='-----END RSA PRIVATE KEY-----';return t};r.prototype.getPublicKey=function(){var t='-----BEGIN PUBLIC KEY-----\n';t+=this.wordwrap(this.getPublicBaseKeyB64())+'\n';t+='-----END PUBLIC KEY-----';return t};r.prototype.hasPublicKeyProperty=function(t){t=t||{};return(t.hasOwnProperty('n')&&t.hasOwnProperty('e'))};r.prototype.hasPrivateKeyProperty=function(t){t=t||{};return(t.hasOwnProperty('n')&&t.hasOwnProperty('e')&&t.hasOwnProperty('d')&&t.hasOwnProperty('p')&&t.hasOwnProperty('q')&&t.hasOwnProperty('dmp1')&&t.hasOwnProperty('dmq1')&&t.hasOwnProperty('coeff'))};r.prototype.parsePropertiesFrom=function(t){this.n=t.n;this.e=t.e;if(t.hasOwnProperty('d')){this.d=t.d;this.p=t.p;this.q=t.q;this.dmp1=t.dmp1;this.dmq1=t.dmq1;this.coeff=t.coeff}};var T=function(t){r.call(this);if(t){if(typeof t==='string'){this.parseKey(t)}else if(this.hasPrivateKeyProperty(t)||this.hasPublicKeyProperty(t)){this.parsePropertiesFrom(t)}}};T.prototype=new r();T.prototype.constructor=T;var a=function(t){t=t||{};this.default_key_size=parseInt(t.default_key_size)||1024;this.default_public_exponent=t.default_public_exponent||'010001';this.log=t.log||!1;this.key=null};a.prototype.setKey=function(t){if(this.log&&this.key){console.warn('A key was already set, overriding existing.')};this.key=new T(t)};a.prototype.setPrivateKey=function(t){this.setKey(t)};a.prototype.setPublicKey=function(t){this.setKey(t)};a.prototype.decrypt=function(t){try{return this.getKey().decrypt(j(t))}catch(e){return!1}};a.prototype.encrypt=function(t){try{return N(this.getKey().encrypt(t))}catch(e){return!1}};a.prototype.getKey=function(t){if(!this.key){this.key=new T();if(t&&{}.toString.call(t)==='[object Function]'){this.key.generateAsync(this.default_key_size,this.default_public_exponent,t);return};this.key.generate(this.default_key_size,this.default_public_exponent)};return this.key};a.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()};a.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()};a.prototype.getPublicKey=function(){return this.getKey().getPublicKey()};a.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()};exports.JSEncrypt=a})(JSEncryptExports);var JSEncrypt=JSEncryptExports.JSEncrypt;