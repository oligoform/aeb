;define(function(require){'use strict';var r=require('backbone'),s=require('root/config'),a=require('underscore');require('localstorage');var i=r.Model.extend({defaults:{id:'',data:{}}});var o=r.Collection.extend({localStorage:new r.LocalStorage('Flags-'+s.app_slug),model:i,resetAll:function(){var e=this.length;for(var t=e-1;t>=0;t--){this.at(t).destroy()};this.reset()}});var e=new o();e.fetch();var n={raise:function(t,r){if(a.isEmpty(r)){r={}};var n=e.add({id:t,data:r});n.save()},lower:function(t){var a=e.get(t);if(a){a.destroy();e.remove(t)}},setData:function(t,n){var r=e.get(t);if(!a.isEmpty(r)){r.set({data:n});r=e.set(r,{add:!1,remove:!1});r.save()}},get:function(t){var a=e.get(t);return a?a.clone():null},getData:function(t){var a=e.get(t);return a?a.get('data'):null},isUp:function(t){var r=e.get(t);return!a.isEmpty(r)},isDown:function(t){var r=e.get(t);return a.isEmpty(r)},getAllFlags:function(){return e.clone()}};return n});